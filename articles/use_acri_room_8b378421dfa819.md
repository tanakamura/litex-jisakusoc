---
title: "ACRiãƒ«ãƒ¼ãƒ ã®Arty A7ã‚’ä½¿ã†"
emoji: "ğŸ•"
type: "tech"
topics: ["FPGA"]
published: true
---
# ACRiãƒ«ãƒ¼ãƒ ã®Arty A7ã‚’ä½¿ã†

Artyã‚’ä½¿ã£ã¦ã¿ãŸã„ã‘ã©ã€FPGAã®ãƒœãƒ¼ãƒ‰ã‚’è²·ã†ã»ã©ã§ã¯ãªã„ã‹ãªã€ã¨ã„ã†äººã¯ã€

https://gw.acri.c.titech.ac.jp/wp/

ACRiãƒ«ãƒ¼ãƒ ã¨ã„ã†æ–½è¨­ã®ç’°å¢ƒã‚’ä½¿ã£ã¦ã¿ã‚‹ã®ã‚‚ã‚ˆã„ã¨æ€ã†ã€‚

ACRiãƒ«ãƒ¼ãƒ ã®ç´¹ä»‹ã¯ãƒªãƒ³ã‚¯å…ˆã‚’èª­ã‚“ã§ã‚‚ã‚‰ã†ã®ãŒã„ã„ã¨æ€ã†ãŒã€https://www.acri.c.titech.ac.jp/wp/ ã‚¢ãƒ€ãƒ—ãƒ†ã‚£ãƒ–ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ç ”ç©¶æ¨é€²ä½“ï¼ˆACRiï¼‰ ã¨ã„ã†å›£ä½“ãŒã€

> å…±é€šã® FPGA ç’°å¢ƒã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ã§é–‹ç™ºæˆæœã‚‚ãƒˆãƒ©ãƒ–ãƒ«ã‚‚ç°¡å˜ã«å…±æœ‰ã§ãã‚‹ç’°å¢ƒã®æä¾›ã‚’ç›®æŒ‡ã—ã¦ã„ã¾ã™ã€‚

ã¨ã„ã†ã“ã¨ã‚’ç›®çš„ã«ã—ã¦é–‹è¨­ã—ã¦ã„ã‚‹æ–½è¨­ã€ã‚‰ã—ã„ã€‚(ãªã‚“ã§ç„¡æ–™ãªã®ã‹ã¯ã‚ˆãã‚ã‹ã‚‰ãªã„ãŒã€å­¦ç”Ÿã•ã‚“é”ã«ã¯ã‚ˆã„ç’°å¢ƒã ã¨æ€ã†ã€‚ç¤¾ä¼šäººã¯è‡ªåˆ†ã§ãƒœãƒ¼ãƒ‰ã‚’è²·ã„ã¾ã—ã‚‡ã†)

ã„ã¾ã®ã¨ã“ã‚ã€ã„ã¤è¦‹ã¦ã‚‚ã‹ãªã‚Šç©ºã„ã¦ã„ã‚‹ã‚ˆã†ãªã®ã§ã€æ—¥ä¸­ã¯å¿…è¦ãªã¨ãã«å€Ÿã‚Šã‚‹ã“ã¨ãŒã§ãã‚‹ã¨æ€ã†(æ·±å¤œã¯ã‚„ã£ã¦ã„ãªã„ã€‚å¤šåˆ†ç«äº‹ã®å¿ƒé…ã¨ã‹ã§ã¯ãªã„ã‹ãªâ€¦)ã€‚


åŸºæœ¬çš„ãªä½¿ã„ã‹ãŸã¯ã€

ã¾ãšã€ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ç”³è«‹ã™ã‚‹ã€‚

https://gw.acri.c.titech.ac.jp/wp/manual/apply-for-account

ç§ã®å ´åˆã¯ã€ç”³è«‹ã—ã¦ã‹ã‚‰2æ—¥ã§ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆã®ãƒ¡ãƒ¼ãƒ«ãŒæ¥ãŸã€‚(9/5ã«ç”³è«‹ã—ã¦ã€9/7ã«ãƒ¡ãƒ¼ãƒ«ãŒæ¥ãŸ)

ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã¯Webäºˆç´„ã‚µãƒ¼ãƒ“ã‚¹ç”¨ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã¨ã€Linuxãƒ­ã‚°ã‚¤ãƒ³ç”¨ã®äºŒã¤ãŒä½œã‚‰ã‚Œã‚‹ã€‚IDã¯ä¸€ç·’ã ãŒã€ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯ç•°ãªã‚‹ã®ã§æ³¨æ„ã€‚

ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒã§ããŸã‚‰ã€

https://gw.acri.c.titech.ac.jp/wp/wp-login.php

äºˆç´„ã‚·ã‚¹ãƒ†ãƒ ã«ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã€ç©ºã„ã¦ã‚‹æ™‚é–“ã‚’äºˆç´„ã™ã‚‹ã€‚ã“ã‚Œã¯äºˆç´„ã‚µãƒ¼ãƒ“ã‚¹ç”¨ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã§ãƒ­ã‚°ã‚¤ãƒ³ã™ã‚‹ã€‚
00:00-9:00 ä»¥å¤–ãªã‚‰ã„ã¤ã§ã‚‚äºˆç´„ã§ãã‚‹ã€‚Arty ã¯16å°å­˜åœ¨ã—ã¦ã„ã¦ã€äºˆç´„ã—ã¦ã„ã‚‹äººã¯å¤šãã¦ä¸€äººãªã®ã§ã€äºˆç´„å–ã‚Œãªã„ã¨ã„ã†ã“ã¨ã¯ãªã„ã¨æ€ã†(2021/10/24ã«è¦‹ãŸã¨ã“ã‚)

Arty ã§ã¯ãªãã¦ã€ã‚‚ã£ã¨ã§ã‹ã„Alveoã‚‚ã‹ãªã‚Šç©ºã„ã¦ã„ã¦ã€è¦‹ã¦ã„ã‚‹é™ã‚Šã ã¨ã„ã¤ã§ã‚‚äºˆç´„ã§ãã‚‹(ï¼ï¼Ÿ)ã€‚

äºˆç´„ã—ãŸã‚‰ã€ã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤ã‚µãƒ¼ãƒãƒ¼(gw.acri.c.titech.ac.jp)ã«sshæ¥ç¶šã™ã‚‹ã€‚ã“ã‚Œã¯Linuxãƒ­ã‚°ã‚¤ãƒ³ç”¨ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã§ãƒ­ã‚°ã‚¤ãƒ³ã™ã‚‹ã€‚

    $ # æ‰‹å…ƒã®ãƒã‚·ãƒ³ã‹ã‚‰
    $ ssh gw.acri.c.titech.ac.jp

ã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤ã‚µãƒ¼ãƒãƒ¼ã«ãƒ­ã‚°ã‚¤ãƒ³ã§ããŸã‚‰ã€ãã“ã‹ã‚‰ vs001, vs002 ãªã©ã«ãƒ­ã‚°ã‚¤ãƒ³ã™ã‚‹ã€‚ã“ã‚Œã‚‚Linuxãƒ­ã‚°ã‚¤ãƒ³ç”¨ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã§ãƒ­ã‚°ã‚¤ãƒ³ã™ã‚‹ã€‚

    $ # gw.acri.c.titech.ac.jp ã«ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã‹ã‚‰
    $ ssh vs002

ã“ã‚Œã§ Arty ã®ç¹‹ãŒã£ãŸPCãŒä½¿ãˆã‚‹ã€‚Vivadoã¯ã€/tools/Xilinx/Vivado ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã¦ã€

    $ source /tools/Xilinx/Vivado/2021.1/settings64.sh
    $ vivado -mode tcl
    
    ****** Vivado v2021.1 (64-bit)
      **** SW Build 3247384 on Thu Jun 10 19:36:07 MDT 2021
      **** IP Build 3246043 on Fri Jun 11 00:30:35 MDT 2021
        ** Copyright 1986-2021 Xilinx, Inc. All Rights Reserved.
    
    Vivado% exit
    exit
    INFO: [Common 17-206] Exiting Vivado at Sun Oct 24 09:52:15 2021...

ã“ã‚“ãªæ„Ÿã˜ã§ä½¿ãˆã‚‹ã€‚

# make.py ã§ä½œã£ãŸãƒ“ãƒƒãƒˆã‚¹ãƒˆãƒªãƒ¼ãƒ ã‚’FPGAã«å…¥ã‚Œã‚‹

https://zenn.dev/tanakmura/articles/litex_linux_ae3feff0b48ede.md

ã“ã‚Œã§ä½œã£ãŸbitstreamã‚’ä½¿ã£ã¦ã¿ã‚ˆã†ã€‚ãƒªãƒ³ã‚¯å…ˆã®è§£èª¬ã§ã¯ã€`--board=arty` ã§ä½œã£ã¦ã„ãŸãŒã€Arty A7å‘ã‘ã«ä½œã‚‹ã¨ãã¯`--board=arty_a7` ã«ã™ã‚‹ã€‚

    $ ./make.py --board=arty_a7 --build

(ãªãŠã€ã„ã¾ã®ã¨ã“ã‚é•ã„ã¯ãªã„ã‚ˆã†ãªã®ã§ã€æ°—ã«ã—ãªãã¦ã„ã„ã‹ã‚‚ã—ã‚Œãªã„)


åˆæˆãŒçµ‚ã‚ã‚‹ã¨ã€`build/arty/gateware/arty.bit` ã« bitstream ãŒã§ãã‚‹ã®ã§ãªã‚“ã¨ã‹ã—ã¦ACRiãƒ«ãƒ¼ãƒ ã®ã‚µãƒ¼ãƒãƒ¼ã«ã‚³ãƒ”ãƒ¼ã™ã‚‹ã€‚

https://gw.acri.c.titech.ac.jp/wp/manual/how-to-reserve#toc6

ã“ã®æ‰‹é †ã‚’å‚è€ƒã«ã—ã¦ã‚‚ã‚ˆã„ã—ã€sftp ã¨ã‹ã‚’ä½¿ã£ã¦ã‚‚ã‚ˆã„ã¨æ€ã†ã€‚(ã‚ã‹ã‚‰ãªã„åˆå¿ƒè€…ã®äººã¯æ¥ãšã‹ã—ãŒã‚‰ãªã„ã§ã‚³ãƒ¡ãƒ³ãƒˆã«æ›¸ã„ã¦ã­)


ã“ã®ã‚ã¨ã€æ­£è¦ã®æ‰‹é †ã§ã¯ã€ãƒªãƒ¢ãƒ¼ãƒˆãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—æ¥ç¶šã—ã¦Vivadoã‚’èµ·å‹•ã™ã‚‹ã®ã ã‘ã©ã€ã‚ã‚“ã©ã„ã®ã§`xsdb` ã§æ›¸ãã€‚


```
 $ cat > program.tcl
connect
fpga "~/arty.bit"
 $ xsdb program.tcl
rlwrap: warning: your $TERM is 'screen.xterm-256color' but rlwrap couldn't find it in the terminfo database. Expect some problems.
attempting to launch hw_server
p
****** Xilinx hw_server v2021.1.0
  **** Build date : Jun  5 2021 at 17:46:51
    ** Copyright 1986-2021 Xilinx, Inc. All Rights Reserved.

INFO: hw_server application started
INFO: Use Ctrl-C to exit hw_server application

INFO: To connect to this hw_server instance use url: TCP:127.0.0.1:3121

called Tcl_FindHashEntry on deleted table
/tools/Xilinx/Vitis/2021.1/bin/loader: line 312: 26368 Aborted                 (core dumped) "$RDI_PROG" "$@"
```

`xsdb`ã‚’èµ·å‹•ã—ã¦ã€`connect`ã€`fpga "bitstream"`ã¨ã™ã‚Œã°ã€æŒ‡å®šã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’FPGAã«æ›¸ãã“ã‚ã‚‹ã€‚


(æœ€å¾Œã«core dumpã—ã¦ã„ã‚‹ãŒã€ã¾ã‚Xilinxã®ãƒ„ãƒ¼ãƒ«ãªã®ã§â€¦)


æˆåŠŸã—ã¦ã„ã‚Œã°ã€UARTã«litexã®biosã®ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ãŒå‡ºã‚‹ã¯ãšã ã€‚ACRiãƒ«ãƒ¼ãƒ ã®ã‚µãƒ¼ãƒãƒ¼ã«ã¯`miniterm`ãŒå…¥ã£ã¦ã„ã‚‹ã®ã§ã“ã‚Œã‚’ä½¿ã£ã¦uartã‚’è¦³å¯Ÿã—ã‚ˆã†ã€‚

```
$ miniterm --raw /dev/ttyUSB1 1000000
```
ãªã©ã™ã‚Œã°ã€FPGAã®UARTã«1MHzã§æ¥ç¶šã§ãã‚‹ã€‚ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ãŒ`miniterm`ã«å–ã‚‰ã‚Œãªã„ã‚ˆã†ã«ã™ã‚‹ãŸã‚ã«ã€`--raw`ã‚’ä»˜ã‘ã¦ãŠãã€‚


```
$ miniterm --raw /dev/ttyUSB1 1000000
--- Miniterm on /dev/ttyUSB1  1000000,8,N,1 ---
--- Quit: Ctrl+] | Menu: Ctrl+T | Help: Ctrl+T followed by Ctrl+H ---
 BIOS CRC passed (2f3c13ed)

 Migen git sha1: 7507a2b
 LiteX git sha1: 8fa4de5e

--=============== SoC ==================--
CPU:            VexRiscv SMP-LINUX @ 80MHz
BUS:            WISHBONE 32-bit @ 4GiB
CSR:            32-bit data
ROM:            64KiB
SRAM:           8KiB
L2:             0KiB
FLASH:          16384KiB
SDRAM:          262144KiB 16-bit @ 640MT/s (CL-7 CWL-5)
...
```

`miniterm`ã‚’çµ‚äº†ã™ã‚‹ã«ã¯ã€`Ctrl + ]`ã‚’æŠ¼ã™ã€‚


https://gw.acri.c.titech.ac.jp/wp/manual/gallery
